# Hedge Control Backend - Environment Variables (EXAMPLE)
#
# IMPORTANT:
# - Do NOT commit real secrets or credentials.
# - Copy this file to .env (kept local) and fill the values.
# - Rotate any previously committed credentials.

# Database
POSTGRES_USER=change_me
POSTGRES_PASSWORD=change_me
POSTGRES_DB=change_me

# Backend
# Prefer setting DATABASE_URL directly (used by SQLAlchemy).
DATABASE_URL=postgresql+psycopg://change_me:change_me@db:5432/change_me

# Supabase (recommended for Render): prefer the Pooler in TRANSACTION mode.
# Example (add ?sslmode=require):
# DATABASE_URL=postgresql://postgres:<PASSWORD>@aws-<region>.pooler.supabase.com:5432/postgres?sslmode=require
#
# If you use the pooler in SESSION mode and see:
#   FATAL: MaxClientsInSessionMode: max clients reached
# reduce pooling via the variables below (or switch to transaction mode).

# SQLAlchemy pool tuning (safe defaults for Supabase pooler)
DB_POOL_SIZE=1
DB_MAX_OVERFLOW=0
# Optional: disable pooling entirely (useful with transaction poolers)
# DB_USE_NULL_POOL=true

# Local dev (no Postgres): use SQLite file DB.
# DATABASE_URL=sqlite+pysqlite:///./dev-smoke.db

# REQUIRED: strong secret key (do not use defaults)
SECRET_KEY=change_me_to_a_strong_random_value

# Environment
ENVIRONMENT=development

# API documentation
# In production, keep docs disabled by default.
ENABLE_DOCS=true

# API prefix (empty = no prefix)
API_V1_STR=

# CORS (JSON array as string)
# Dev defaults exist in code, but in production you MUST set this explicitly.
CORS_ORIGINS=["http://localhost:5173","https://your-vercel-app.vercel.app"]

# JWT
ACCESS_TOKEN_EXPIRE_MINUTES=60
ALGORITHM=HS256

# Auth mode
# - local: OAuth2 password flow (internal JWT)
# - entra: Microsoft Entra ID access tokens only
# - both: accept either (recommended during migration)
AUTH_MODE=local

# Microsoft Entra ID (Azure AD)
# Required when AUTH_MODE=entra|both.
#
# ENTRA_TENANT_ID: your tenant GUID
# ENTRA_AUDIENCE: recommended = API App ID URI (e.g. api://<api-app-client-id>)
#                (the backend also accepts the raw GUID as audience)
#
# Defaults (if ENTRA_ISSUER/ENTRA_JWKS_URL are omitted):
# ENTRA_ISSUER=https://login.microsoftonline.com/<tenantId>/v2.0
# (The backend also accepts the v1 issuer: https://sts.windows.net/<tenantId>/)
# ENTRA_JWKS_URL=https://login.microsoftonline.com/<tenantId>/discovery/v2.0/keys
ENTRA_TENANT_ID=
ENTRA_AUDIENCE=
ENTRA_ISSUER=
ENTRA_JWKS_URL=

# Optional toggles
SCHEDULER_ENABLED=true

# Optional: token for public, read-only report exports (e.g., Power BI scheduled refresh)
# When set, enables:
#   GET /api/reports/cashflow-ledger-public?token=...&format=csv
REPORTS_PUBLIC_TOKEN=
